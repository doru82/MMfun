<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AVAX Meme Coin Launcher - TESTNET</title>
    <script src="https://unpkg.com/ethers@5.7.2/dist/ethers.umd.min.js"></script>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            text-align: center; 
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        .container {
            background: white;
            border-radius: 20px;
            padding: 40px;
            max-width: 700px;
            margin: 0 auto;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
        }
        .disclaimer {
            background: #d1ecf1;
            border: 3px solid #17a2b8;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            text-align: left;
        }
        .disclaimer h3 { color: #0c5460; margin: 0 0 10px 0; }
        .disclaimer ul { margin: 10px 0; padding-left: 20px; }
        .disclaimer li { margin: 5px 0; color: #0c5460; }
        .accept-terms {
            margin: 15px 0;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
        }
        .accept-terms input { margin-right: 10px; }
        h1 { color: #333; margin-bottom: 10px; }
        .beta-tag {
            display: inline-block;
            background: #17a2b8;
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
        }
        .option-box {
            background: #f8f9fa;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            padding: 20px;
            margin: 15px 0;
            cursor: pointer;
            transition: all 0.3s;
        }
        .option-box:hover { border-color: #667eea; background: #f0f4ff; }
        .option-box.selected { border-color: #4CAF50; background: #e8f5e9; }
        .option-box h3 { margin: 0 0 10px 0; color: #333; }
        .option-box p { margin: 5px 0; color: #666; font-size: 14px; }
        input, select { 
            margin: 10px; 
            padding: 12px; 
            width: 100%; 
            max-width: 400px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 14px;
        }
        button { 
            padding: 12px 30px; 
            background: #4CAF50; 
            color: white; 
            border: none; 
            border-radius: 8px;
            cursor: pointer; 
            font-size: 16px;
            margin: 10px;
            transition: background 0.3s;
        }
        button:hover { background: #45a049; }
        button:disabled { background: #ccc; cursor: not-allowed; }
        #status { 
            margin: 20px; 
            padding: 15px;
            border-radius: 8px;
            font-size: 14px;
        }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        .info { background: #d1ecf1; color: #0c5460; }
        .wallet-info { margin: 15px 0; color: #666; font-size: 14px; }
        .hidden { display: none; }
        .cost-display {
            background: #fff3cd;
            border: 2px solid #ffc107;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
        }
        .cost-display strong { color: #856404; }
        .limits-info {
            background: #e3f2fd;
            border: 2px solid #2196f3;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
            font-size: 13px;
        }
        .test-badge {
            background: #17a2b8;
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üöÄ AVAX Meme Coin Launcher</h1>
        <span class="beta-tag">FUJI TESTNET</span>
        
        <div class="test-badge">
            <strong>üß™ TEST VERSION</strong><br>
            Testing all mainnet features with free test AVAX<br>
            Get test AVAX: <a href="https://core.app/tools/testnet-faucet" target="_blank" style="color: white;">Faucet</a>
        </div>
        
        <div class="disclaimer">
            <h3>‚ö†Ô∏è TESTING DISCLAIMER</h3>
            <ul>
                <li><strong>Testnet Only:</strong> This uses free test AVAX, not real money</li>
                <li><strong>Testing Features:</strong> Liquidity lock, rate limits, supply caps</li>
                <li><strong>No Real Value:</strong> Tokens created here have no monetary value</li>
                <li><strong>Report Bugs:</strong> Help us improve before mainnet!</li>
            </ul>
            
            <div class="accept-terms">
                <input type="checkbox" id="acceptTerms">
                <label for="acceptTerms"><strong>I understand this is testnet and I'm testing features</strong></label>
            </div>
        </div>
        
        <div class="limits-info">
            <strong>üõ°Ô∏è Testing These Limits:</strong><br>
            ‚Ä¢ Max 1 trillion token supply<br>
            ‚Ä¢ Daily limit: 50 launches<br>
            ‚Ä¢ Minimum 30 days liquidity lock<br>
            ‚Ä¢ Minimum 0.1 AVAX liquidity
        </div>
        
        <button onclick="connectWallet()" id="connectBtn" disabled>Connect Wallet (Accept Terms First)</button>
        <button onclick="disconnectWallet()" id="disconnectBtn" class="hidden" style="background: #f44336;">Disconnect</button>
        <div class="wallet-info" id="walletInfo"></div>
        
        <div id="launchOptions" class="hidden">
            <hr style="margin: 20px 0;">
            <h2>Choose Launch Type:</h2>
            
            <div class="option-box" onclick="selectOption('simple')" id="simpleOption">
                <h3>üéØ Simple Launch</h3>
                <p>‚úÖ Deploy token only</p>
                <p>‚úÖ You get 100% of supply</p>
                <p>‚ö†Ô∏è No liquidity = harder to trade</p>
                <p>üí∞ Cost: 0.5 test AVAX</p>
            </div>
            
            <div class="option-box selected" onclick="selectOption('liquidity')" id="liquidityOption">
                <h3>üíß Launch + Auto-Liquidity (TESTING)</h3>
                <p>‚úÖ Deploy + add liquidity on Pangolin</p>
                <p>‚úÖ 80% supply ‚Üí liquidity pool (LOCKED)</p>
                <p>‚úÖ 20% supply ‚Üí you (for marketing)</p>
                <p>‚úÖ Token tradeable immediately!</p>
                <p>üîí Testing liquidity lock (30-365 days)</p>
                <p>üí∞ Cost: 0.5 + liquidity test AVAX</p>
            </div>
        </div>
        
        <div id="launchForm" class="hidden">
            <hr style="margin: 20px 0;">
            <input id="name" placeholder="Token Name (ex: TestMeme)" maxlength="30"><br>
            <input id="symbol" placeholder="Symbol (ex: TM)" maxlength="10"><br>
            <input id="supply" type="number" placeholder="Total Supply (max 1 trillion)" max="1000000000000"><br>
            
            <div id="liquidityInputs" class="hidden">
                <input id="liquidityAVAX" type="number" step="0.1" value="1" placeholder="AVAX for Liquidity (min 0.1)"><br>
                
                <select id="lockDays">
                    <option value="30">Lock 30 days</option>
                    <option value="60">Lock 60 days</option>
                    <option value="90" selected>Lock 90 days</option>
                    <option value="180">Lock 180 days</option>
                    <option value="365">Lock 1 year</option>
                </select><br>
                
                <div class="cost-display">
                    <strong>Total Cost:</strong> <span id="totalCost">1.5 test AVAX</span><br>
                    <small>(0.5 AVAX fee + <span id="liqAmount">1</span> AVAX liquidity)</small><br>
                    <strong>Lock Period:</strong> <span id="lockDisplay">90 days</span>
                </div>
            </div>
            
            <button onclick="launchToken()" id="launchBtn">Launch Token (TEST)</button>
        </div>
        
        <div id="status"></div>
        
        <div style="margin-top: 30px; font-size: 12px; color: #666;">
            <p>üß™ Testnet Version ‚Ä¢ Testing Mainnet Features ‚Ä¢ Free Test AVAX</p>
        </div>
    </div>

    <script>
        // ‚ö†Ô∏è SCHIMBƒÇ CU ADRESA CONTRACTULUI NOU DE PE FUJI! ‚ö†Ô∏è
        const factoryAddress = '0xAd0a081AfAfE422181e86BE8bB68D116bf9bc11c';
        const CHAIN_ID = 43113; // Fuji Testnet
        
        const abiSimple = [
            "function launchToken(string memory name, string memory symbol, uint256 totalSupply) external payable returns (address)"
        ];
        
        const abiWithLiquidity = [
            "function launchTokenWithLiquidity(string memory name, string memory symbol, uint256 totalSupply, uint256 liquidityAVAX, uint256 lockDays) external payable returns (address, uint256, uint256)",
            "event TokenLaunched(address indexed token, address indexed creator, string name, string symbol, address liquidityPair, uint256 liquidityAmount, uint256 lockId)"
        ];
        
        let provider, signer, userAddress;
        let selectedMode = 'liquidity';
        
        document.getElementById('acceptTerms').addEventListener('change', function() {
            document.getElementById('connectBtn').disabled = !this.checked;
        });

        window.addEventListener('load', async () => {
            if (typeof window.ethereum !== 'undefined') {
                const accounts = await window.ethereum.request({ method: 'eth_accounts' });
                if (accounts.length > 0 && document.getElementById('acceptTerms').checked) {
                    await connectWallet();
                }
            }
        });

        async function connectWallet() {
            const statusDiv = document.getElementById('status');
            const connectBtn = document.getElementById('connectBtn');
            
            if (!document.getElementById('acceptTerms').checked) {
                statusDiv.innerHTML = '<div class="error">Please accept terms first!</div>';
                return;
            }
            
            try {
                if (typeof window.ethereum === 'undefined') {
                    statusDiv.innerHTML = '<div class="error">‚ùå No wallet detected! Please install MetaMask.</div>';
                    return;
                }

                statusDiv.innerHTML = '<div class="info">Connecting...</div>';
                
                await window.ethereum.request({ method: 'eth_requestAccounts' });
                provider = new ethers.providers.Web3Provider(window.ethereum);
                signer = provider.getSigner();
                userAddress = await signer.getAddress();
                
                const network = await provider.getNetwork();
                if (network.chainId !== CHAIN_ID) {
                    statusDiv.innerHTML = '<div class="error">‚ùå Switch to Avalanche Fuji Testnet!</div>';
                    try {
                        await window.ethereum.request({
                            method: 'wallet_switchEthereumChain',
                            params: [{ chainId: '0xA869' }],
                        });
                        setTimeout(connectWallet, 1000);
                    } catch (switchError) {
                        if (switchError.code === 4902) {
                            await window.ethereum.request({
                                method: 'wallet_addEthereumChain',
                                params: [{
                                    chainId: '0xA869',
                                    chainName: 'Avalanche Fuji Testnet',
                                    nativeCurrency: { name: 'AVAX', symbol: 'AVAX', decimals: 18 },
                                    rpcUrls: ['https://api.avax-test.network/ext/bc/C/rpc'],
                                    blockExplorerUrls: ['https://testnet.snowtrace.io/']
                                }]
                            });
                            setTimeout(connectWallet, 1000);
                        }
                    }
                    return;
                }
                
                const balance = await provider.getBalance(userAddress);
                const balanceInAvax = ethers.utils.formatEther(balance);
                
                document.getElementById('walletInfo').innerHTML = `
                    ‚úÖ Connected: ${userAddress.substring(0,6)}...${userAddress.substring(38)}<br>
                    üí∞ Balance: ${parseFloat(balanceInAvax).toFixed(4)} test AVAX
                `;
                document.getElementById('launchOptions').classList.remove('hidden');
                document.getElementById('launchForm').classList.remove('hidden');
                connectBtn.classList.add('hidden');
                document.getElementById('disconnectBtn').classList.remove('hidden');
                statusDiv.innerHTML = '<div class="success">‚úÖ Connected to Fuji Testnet! Choose launch type üëÜ</div>';
                
                updateLiquidityInputs();
                
            } catch (error) {
                console.error('Connection error:', error);
                statusDiv.innerHTML = `<div class="error">‚ùå Error: ${error.message}</div>`;
            }
        }

        function disconnectWallet() {
            provider = null;
            signer = null;
            userAddress = null;
            
            document.getElementById('connectBtn').classList.remove('hidden');
            document.getElementById('connectBtn').disabled = !document.getElementById('acceptTerms').checked;
            document.getElementById('disconnectBtn').classList.add('hidden');
            document.getElementById('walletInfo').innerHTML = '';
            document.getElementById('launchOptions').classList.add('hidden');
            document.getElementById('launchForm').classList.add('hidden');
            document.getElementById('status').innerHTML = '';
        }

        function selectOption(mode) {
            selectedMode = mode;
            document.getElementById('simpleOption').classList.remove('selected');
            document.getElementById('liquidityOption').classList.remove('selected');
            document.getElementById(mode + 'Option').classList.add('selected');
            updateLiquidityInputs();
        }

        function updateLiquidityInputs() {
            const liquidityInputs = document.getElementById('liquidityInputs');
            const launchBtn = document.getElementById('launchBtn');
            
            if (selectedMode === 'liquidity') {
                liquidityInputs.classList.remove('hidden');
                launchBtn.innerHTML = 'Launch + Add Liquidity (TEST)';
                updateCost();
            } else {
                liquidityInputs.classList.add('hidden');
                launchBtn.innerHTML = 'Launch Token (TEST)';
            }
        }

        function updateCost() {
            const liqAVAX = parseFloat(document.getElementById('liquidityAVAX').value) || 1;
            const lockDays = document.getElementById('lockDays').value;
            const total = 0.5 + liqAVAX;
            document.getElementById('totalCost').innerHTML = total.toFixed(2) + ' test AVAX';
            document.getElementById('liqAmount').innerHTML = liqAVAX.toFixed(2);
            document.getElementById('lockDisplay').innerHTML = lockDays + ' days';
        }

        document.addEventListener('DOMContentLoaded', function() {
            const liqInput = document.getElementById('liquidityAVAX');
            const lockSelect = document.getElementById('lockDays');
            if (liqInput) liqInput.addEventListener('input', updateCost);
            if (lockSelect) lockSelect.addEventListener('change', updateCost);
        });

        async function launchToken() {
            const statusDiv = document.getElementById('status');
            const launchBtn = document.getElementById('launchBtn');
            
            if (!signer) {
                statusDiv.innerHTML = '<div class="error">Connect wallet first!</div>';
                return;
            }
            
            const name = document.getElementById('name').value.trim();
            const symbol = document.getElementById('symbol').value.trim();
            const supply = document.getElementById('supply').value;
            
            if (!name || !symbol || !supply) {
                statusDiv.innerHTML = '<div class="error">Fill all fields!</div>';
                return;
            }
            
            if (supply > 1000000000000) {
                statusDiv.innerHTML = '<div class="error">Max supply is 1 trillion!</div>';
                return;
            }
            
            launchBtn.disabled = true;
            launchBtn.innerHTML = 'Testing...';
            
            try {
                if (selectedMode === 'simple') {
                    const contract = new ethers.Contract(factoryAddress, abiSimple, signer);
                    statusDiv.innerHTML = '<div class="info">‚è≥ Testing simple deploy...</div>';
                    
                    const tx = await contract.launchToken(name, symbol, supply, { 
                        value: ethers.utils.parseEther('0.5')
                    });
                    
                    statusDiv.innerHTML = `<div class="info">‚è≥ Waiting...<br>Tx: ${tx.hash}</div>`;
                    const receipt = await tx.wait();
                    const tokenAddr = receipt.events[0].args.token;
                    
                    statusDiv.innerHTML = `
                        <div class="success">
                            üéâ Test successful! Token deployed!<br><br>
                            <strong>Address:</strong> ${tokenAddr}<br><br>
                            <a href="https://testnet.snowtrace.io/address/${tokenAddr}" target="_blank">View on Snowtrace ‚Üí</a>
                        </div>
                    `;
                    
                } else {
                    const contract = new ethers.Contract(factoryAddress, abiWithLiquidity, signer);
                    const liqAVAX = document.getElementById('liquidityAVAX').value;
                    const lockDays = document.getElementById('lockDays').value;
                    
                    if (parseFloat(liqAVAX) < 0.1) {
                        statusDiv.innerHTML = '<div class="error">Minimum 0.1 AVAX for liquidity!</div>';
                        launchBtn.disabled = false;
                        launchBtn.innerHTML = 'Launch + Add Liquidity (TEST)';
                        return;
                    }
                    
                    const totalValue = 0.5 + parseFloat(liqAVAX);
                    
                    statusDiv.innerHTML = '<div class="info">‚è≥ Testing deploy + liquidity + lock...</div>';
                    
                    const tx = await contract.launchTokenWithLiquidity(
                        name, 
                        symbol, 
                        supply,
                        ethers.utils.parseEther(liqAVAX),
                        lockDays,
                        { value: ethers.utils.parseEther(totalValue.toString()) }
                    );
                    
                    statusDiv.innerHTML = `<div class="info">‚è≥ Processing test...<br>Tx: ${tx.hash}</div>`;
                    const receipt = await tx.wait();
                    
                    const event = receipt.events.find(e => e.event === 'TokenLaunched');
                    const tokenAddr = event.args.token;
                    const lockId = event.args.lockId;
                    
                    statusDiv.innerHTML = `
                        <div class="success">
                            üéâ Test successful! All features working!<br><br>
                            <strong>Token:</strong> ${tokenAddr}<br>
                            <strong>You received:</strong> 20% supply (${supply * 0.2} tokens)<br>
                            <strong>Liquidity:</strong> 80% supply on Pangolin (LOCKED)<br>
                            <strong>Lock ID:</strong> ${lockId.toString()} (${lockDays} days)<br><br>
                            ‚úÖ Liquidity lock working!<br>
                            ‚úÖ Rate limits working!<br>
                            ‚úÖ Supply cap working!<br><br>
                            <a href="https://testnet.snowtrace.io/address/${tokenAddr}" target="_blank">View on Snowtrace ‚Üí</a><br>
                            <a href="https://app.pangolin.exchange/#/swap?outputCurrency=${tokenAddr}" target="_blank">Trade on Pangolin ‚Üí</a>
                        </div>
                    `;
                }
                
                document.getElementById('name').value = '';
                document.getElementById('symbol').value = '';
                document.getElementById('supply').value = '';
                
            } catch (error) {
                console.error('Test error:', error);
                statusDiv.innerHTML = `<div class="error">‚ùå Test failed: ${error.message}<br><br>This helps us fix bugs before mainnet!</div>`;
            } finally {
                launchBtn.disabled = false;
                updateLiquidityInputs();
            }
        }

        if (typeof window.ethereum !== 'undefined') {
            window.ethereum.on('accountsChanged', () => location.reload());
            window.ethereum.on('chainChanged', () => location.reload());
        }
    </script>
</body>
</html>
