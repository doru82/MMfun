<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AVAX Meme Coin Launcher</title>
    <link rel="icon" type="image/png" href="https://cryptologos.cc/logos/avalanche-avax-logo.png">
    <script src="https://cdn.jsdelivr.net/npm/ethers@5.6.9/dist/ethers.umd.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body { 
            font-family: 'Segoe UI', Arial, sans-serif; 
            background: linear-gradient(135deg, #E84142 0%, #C62828 100%);
            min-height: 100vh;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .logo {
            width: 80px;
            height: 80px;
            margin-bottom: 20px;
            filter: drop-shadow(0 4px 8px rgba(0,0,0,0.2));
        }
        
        .container {
            background: white;
            border-radius: 24px;
            padding: 40px;
            max-width: 600px;
            width: 100%;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        
        h1 { 
            color: #333; 
            margin-bottom: 10px;
            font-size: 28px;
            text-align: center;
        }
        
        .beta-tag {
            display: block;
            text-align: center;
            background: #E84142;
            color: white;
            padding: 8px 20px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
            margin: 0 auto 20px auto;
            width: fit-content;
        }
        
        .terms-box {
            background: #f8f9fa;
            border: 2px solid #dee2e6;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .terms-box label {
            display: flex;
            align-items: flex-start;
            gap: 10px;
            cursor: pointer;
            font-size: 14px;
            line-height: 1.5;
        }
        
        .terms-box input[type="checkbox"] {
            margin-top: 3px;
            width: 18px;
            height: 18px;
            cursor: pointer;
            flex-shrink: 0;
        }
        
        .limits-info {
            background: #e3f2fd;
            border: 2px solid #2196f3;
            border-radius: 12px;
            padding: 15px;
            margin: 15px 0;
            font-size: 13px;
            text-align: center;
        }
        
        .option-box {
            background: #f8f9fa;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            padding: 20px;
            margin: 15px 0;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .option-box:hover { 
            border-color: #E84142; 
            background: #fff5f5;
            transform: translateY(-2px);
        }
        
        .option-box.selected { 
            border-color: #4CAF50; 
            background: #e8f5e9;
        }
        
        .option-box h3 { 
            margin: 0 0 10px 0; 
            color: #333;
            font-size: 18px;
        }
        
        .option-box p { 
            margin: 5px 0; 
            color: #666; 
            font-size: 14px;
        }
        
        input, select { 
            margin: 10px 0; 
            padding: 14px; 
            width: 100%;
            border: 2px solid #ddd;
            border-radius: 10px;
            font-size: 15px;
            transition: border 0.3s;
        }
        
        input:focus, select:focus {
            outline: none;
            border-color: #E84142;
        }
        
        button { 
            padding: 14px 32px; 
            background: #4CAF50; 
            color: white; 
            border: none; 
            border-radius: 10px;
            cursor: pointer; 
            font-size: 16px;
            font-weight: bold;
            margin: 10px 0;
            width: 100%;
            transition: all 0.3s;
        }
        
        button:hover { 
            background: #45a049;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(76, 175, 80, 0.3);
        }
        
        button:disabled { 
            background: #ccc; 
            cursor: not-allowed;
            transform: none;
        }
        
        button.disconnect { background: #f44336; }
        button.disconnect:hover { background: #da190b; }
        
        #status { 
            margin: 20px 0; 
            padding: 15px;
            border-radius: 10px;
            font-size: 14px;
            line-height: 1.6;
        }
        
        .success { background: #d4edda; color: #155724; border: 2px solid #c3e6cb; }
        .error { background: #f8d7da; color: #721c24; border: 2px solid #f5c6cb; }
        .info { background: #d1ecf1; color: #0c5460; border: 2px solid #bee5eb; }
        
        .wallet-info { 
            margin: 15px 0; 
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
            color: #666; 
            font-size: 14px;
            text-align: center;
        }
        
        .hidden { display: none !important; }
        
        .cost-display {
            background: #fff3cd;
            border: 2px solid #ffc107;
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
            text-align: center;
        }
        
        .cost-display strong { color: #856404; }
        
        .disclaimer {
            background: #f8f9fa;
            border-top: 2px solid #dee2e6;
            padding: 20px;
            margin-top: 30px;
            border-radius: 0 0 24px 24px;
            margin-left: -40px;
            margin-right: -40px;
            margin-bottom: -40px;
            text-align: center;
            font-size: 12px;
            color: #6c757d;
            line-height: 1.8;
        }
        
        .disclaimer strong { color: #495057; display: block; margin-bottom: 10px; }
        
        a { color: #E84142; text-decoration: none; font-weight: 600; }
        a:hover { text-decoration: underline; }
    </style>
</head>
<body>
    <img src="https://cryptologos.cc/logos/avalanche-avax-logo.png" alt="Avalanche" class="logo">

    <div class="container">
        <h1>üöÄ Meme Coin Launcher</h1>
        <span class="beta-tag">AVALANCHE MAINNET</span>
        
        <div class="terms-box">
            <label>
                <input type="checkbox" id="acceptTerms">
                <span><strong>I understand:</strong> This is MAINNET. Real AVAX will be spent. Tokens are experimental. No guarantees. Creator not liable for losses. DYOR.</span>
            </label>
        </div>
        
        <div class="limits-info">
            <strong>üõ°Ô∏è Safety Features:</strong><br>
            Max 1 trillion supply ‚Ä¢ Daily limit: 5 launches per user ‚Ä¢ Min 0.1 AVAX liquidity
        </div>
        
        <button onclick="connectWallet()" id="connectBtn" disabled>Connect Wallet</button>
        <button onclick="disconnectWallet()" id="disconnectBtn" class="disconnect hidden">Disconnect</button>
        <div class="wallet-info hidden" id="walletInfo"></div>
        
        <div id="launchOptions" class="hidden">
            <hr style="margin: 20px 0; border: none; border-top: 1px solid #dee2e6;">
            
            <div class="option-box" onclick="selectOption('simple')" id="simpleOption">
                <h3>üéØ Simple Launch</h3>
                <p>‚úÖ Deploy token only</p>
                <p>‚úÖ 100% supply to you</p>
                <p>üí∞ Cost: 0.5 AVAX</p>
            </div>
            
            <div class="option-box selected" onclick="selectOption('liquidity')" id="liquidityOption">
                <h3>üíß Launch + Auto-Liquidity</h3>
                <p>‚úÖ Deploy + add liquidity</p>
                <p>‚úÖ 80% ‚Üí pool, 20% ‚Üí you</p>
                <p>‚úÖ Tradeable instantly!</p>
                <p>üí∞ Cost: 0.5 + liquidity AVAX</p>
            </div>
        </div>
        
        <div id="launchForm" class="hidden">
            <input id="name" placeholder="Token Name (ex: TestMeme)" maxlength="30">
            <input id="symbol" placeholder="Symbol (ex: TM)" maxlength="10">
            <input id="supply" type="number" placeholder="Total Supply (max 1 trillion)" max="1000000000000">
            
            <div id="liquidityInputs" class="hidden">
                <input id="liquidityAVAX" type="number" step="0.1" value="1" placeholder="AVAX for Liquidity (min 0.1)">
                
                <div class="cost-display">
                    <strong>Total Cost:</strong> <span id="totalCost">1.5 AVAX</span><br>
                    <small>(0.5 AVAX fee + <span id="liqAmount">1</span> AVAX liquidity)</small>
                </div>
            </div>
            
            <button onclick="launchToken()" id="launchBtn">Launch Token</button>
        </div>
        
        <div id="status"></div>
        
        <div class="disclaimer">
            <strong>‚ö†Ô∏è DISCLAIMER</strong>
            This is an experimental hobby project for educational purposes. No guarantees, warranties, or financial advice. Contracts are not professionally audited. Use at your own risk. Creator not liable for any losses. Always DYOR.
        </div>
    </div>

    <script>
        const factoryAddress = '0xd5AA784dcF759f477af9c4a05245b8151826CCCf';
        const CHAIN_ID = 43114;
        
        const abiSimple = ["function launchToken(string memory name, string memory symbol, uint256 totalSupply) external payable returns (address)"];
        const abiWithLiquidity = [
            "function launchTokenWithLiquidity(string memory name, string memory symbol, uint256 totalSupply, uint256 liquidityAVAX) external payable returns (address, uint256)",
            "event TokenLaunched(address indexed token, address indexed creator, string name, string symbol, uint256 liquidity)"
        ];
        
        let provider, signer, userAddress;
        let selectedMode = 'liquidity';
        
        document.getElementById('acceptTerms').addEventListener('change', function() {
            document.getElementById('connectBtn').disabled = !this.checked;
        });

        async function connectWallet() {
            const statusDiv = document.getElementById('status');
            const connectBtn = document.getElementById('connectBtn');
            
            if (!document.getElementById('acceptTerms').checked) {
                statusDiv.innerHTML = '<div class="error">Please accept terms first!</div>';
                return;
            }
            
            try {
                if (typeof window.ethereum === 'undefined') {
                    statusDiv.innerHTML = '<div class="error">‚ùå No wallet detected! Install MetaMask.</div>';
                    return;
                }

                statusDiv.innerHTML = '<div class="info">Connecting...</div>';
                
                const accounts = await window.ethereum.request({ method: 'eth_requestAccounts' });
                provider = new ethers.providers.Web3Provider(window.ethereum);
                signer = provider.getSigner();
                userAddress = accounts[0];
                
                const balance = await provider.getBalance(userAddress);
                const balanceInAvax = ethers.utils.formatEther(balance);
                
                document.getElementById('walletInfo').innerHTML = `
                    ‚úÖ <strong>Connected:</strong> ${userAddress.substring(0,6)}...${userAddress.substring(38)}<br>
                    üí∞ <strong>Balance:</strong> ${parseFloat(balanceInAvax).toFixed(4)} AVAX
                `;
                document.getElementById('walletInfo').classList.remove('hidden');
                document.getElementById('launchOptions').classList.remove('hidden');
                document.getElementById('launchForm').classList.remove('hidden');
                connectBtn.classList.add('hidden');
                document.getElementById('disconnectBtn').classList.remove('hidden');
                statusDiv.innerHTML = '<div class="success">‚úÖ Ready to launch!</div>';
                
                updateLiquidityInputs();
                
            } catch (error) {
                console.error('Connection error:', error);
                statusDiv.innerHTML = `<div class="error">‚ùå Error: ${error.message}</div>`;
            }
        }

        function disconnectWallet() {
            provider = null;
            signer = null;
            userAddress = null;
            
            document.getElementById('connectBtn').classList.remove('hidden');
            document.getElementById('connectBtn').disabled = !document.getElementById('acceptTerms').checked;
            document.getElementById('disconnectBtn').classList.add('hidden');
            document.getElementById('walletInfo').classList.add('hidden');
            document.getElementById('launchOptions').classList.add('hidden');
            document.getElementById('launchForm').classList.add('hidden');
            document.getElementById('status').innerHTML = '';
        }

        function selectOption(mode) {
            selectedMode = mode;
            document.getElementById('simpleOption').classList.remove('selected');
            document.getElementById('liquidityOption').classList.remove('selected');
            document.getElementById(mode + 'Option').classList.add('selected');
            updateLiquidityInputs();
        }

        function updateLiquidityInputs() {
            const liquidityInputs = document.getElementById('liquidityInputs');
            const launchBtn = document.getElementById('launchBtn');
            
            if (selectedMode === 'liquidity') {
                liquidityInputs.classList.remove('hidden');
                launchBtn.innerHTML = 'Launch + Add Liquidity';
                updateCost();
            } else {
                liquidityInputs.classList.add('hidden');
                launchBtn.innerHTML = 'Launch Token (0.5 AVAX)';
            }
        }

        function updateCost() {
            const liqAVAX = parseFloat(document.getElementById('liquidityAVAX').value) || 1;
            const total = 0.5 + liqAVAX;
            document.getElementById('totalCost').innerHTML = total.toFixed(2) + ' AVAX';
            document.getElementById('liqAmount').innerHTML = liqAVAX.toFixed(2);
        }

        document.addEventListener('DOMContentLoaded', function() {
            const liqInput = document.getElementById('liquidityAVAX');
            if (liqInput) liqInput.addEventListener('input', updateCost);
        });

        async function launchToken() {
            const statusDiv = document.getElementById('status');
            const launchBtn = document.getElementById('launchBtn');
            
            if (!signer) {
                statusDiv.innerHTML = '<div class="error">Connect wallet first!</div>';
                return;
            }
            
            const name = document.getElementById('name').value.trim();
            const symbol = document.getElementById('symbol').value.trim();
            const supply = document.getElementById('supply').value;
            
            if (!name || !symbol || !supply) {
                statusDiv.innerHTML = '<div class="error">Fill all fields!</div>';
                return;
            }
            
            if (supply > 1000000000000) {
                statusDiv.innerHTML = '<div class="error">Max supply is 1 trillion!</div>';
                return;
            }
            
            launchBtn.disabled = true;
            launchBtn.innerHTML = 'Launching...';
            
            try {
                if (selectedMode === 'simple') {
                    const contract = new ethers.Contract(factoryAddress, abiSimple, signer);
                    statusDiv.innerHTML = '<div class="info">‚è≥ Deploying token...</div>';
                    
                    const tx = await contract.launchToken(name, symbol, supply, { 
                        value: ethers.utils.parseEther('0.5')
                    });
                    
                    statusDiv.innerHTML = `<div class="info">‚è≥ Waiting...<br>Tx: <a href="https://snowtrace.io/tx/${tx.hash}" target="_blank">${tx.hash.substring(0,10)}...</a></div>`;
                    const receipt = await tx.wait();
                    
                    // Parse token address from event logs
                    let tokenAddr = null;
                    for (const log of receipt.logs) {
                        if (log.topics.length > 1) {
                            try {
                                tokenAddr = '0x' + log.topics[1].slice(26);
                                break;
                            } catch (e) {}
                        }
                    }
                    
                    if (!tokenAddr) {
                        throw new Error('Could not find token address in transaction');
                    }
                    
                    statusDiv.innerHTML = `
                        <div class="success">
                            üéâ Token deployed on Mainnet!<br><br>
                            <strong>Address:</strong> ${tokenAddr}<br><br>
                            <a href="https://snowtrace.io/address/${tokenAddr}" target="_blank">View on Snowtrace ‚Üí</a>
                        </div>
                    `;
                    
                } else {
                    const contract = new ethers.Contract(factoryAddress, abiWithLiquidity, signer);
                    const liqAVAX = document.getElementById('liquidityAVAX').value;
                    
                    if (parseFloat(liqAVAX) < 0.1) {
                        statusDiv.innerHTML = '<div class="error">Minimum 0.1 AVAX!</div>';
                        launchBtn.disabled = false;
                        launchBtn.innerHTML = 'Launch + Add Liquidity';
                        return;
                    }
                    
                    const totalValue = 0.5 + parseFloat(liqAVAX);
                    
                    statusDiv.innerHTML = '<div class="info">‚è≥ Deploying + adding liquidity...</div>';
                    
                    const tx = await contract.launchTokenWithLiquidity(
                        name, 
                        symbol, 
                        supply,
                        ethers.utils.parseEther(liqAVAX),
                        { value: ethers.utils.parseEther(totalValue.toString()) }
                    );
                    
                    statusDiv.innerHTML = `<div class="info">‚è≥ Processing...<br>Tx: <a href="https://snowtrace.io/tx/${tx.hash}" target="_blank">${tx.hash.substring(0,10)}...</a></div>`;
                    const receipt = await tx.wait();
                    
                    const event = receipt.events.find(e => e.event === 'TokenLaunched');
                    const tokenAddr = event.args.token;
                    
                    statusDiv.innerHTML = `
                        <div class="success">
                            üéâ Success! Mainnet Launch Complete!<br><br>
                            <strong>Token:</strong> ${tokenAddr}<br>
                            <strong>You got:</strong> 20% supply<br>
                            <strong>Liquidity:</strong> 80% on Pangolin<br><br>
                            <a href="https://snowtrace.io/address/${tokenAddr}" target="_blank">View on Snowtrace ‚Üí</a><br>
                            <a href="https://app.pangolin.exchange/#/swap?outputCurrency=${tokenAddr}" target="_blank">Trade on Pangolin ‚Üí</a>
                        </div>
                    `;
                }
                
                document.getElementById('name').value = '';
                document.getElementById('symbol').value = '';
                document.getElementById('supply').value = '';
                
            } catch (error) {
                console.error('Error:', error);
                let errorMsg = error.message;
                if (error.message.includes('insufficient funds')) {
                    errorMsg = 'Insufficient AVAX! You need more AVAX for gas + fees.';
                }
                statusDiv.innerHTML = `<div class="error">‚ùå ${errorMsg}</div>`;
            } finally {
                launchBtn.disabled = false;
                updateLiquidityInputs();
            }
        }

        if (typeof window.ethereum !== 'undefined') {
            window.ethereum.on('accountsChanged', () => location.reload());
            window.ethereum.on('chainChanged', () => location.reload());
        }
    </script>
</body>
</html>